on: [push]

name: Azure Login

env:
  tf_version: 'latest'
  tf_working_dir: './rancher-rke-ha'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v1
      # - name: Login to Azure
      #   uses: azure/login@v1
      #   with:
      #     creds: ${{ secrets.AZURE_SUB_MPN }}
      - uses: secrethub/actions/env-export@v0.1.0
        env:
          SECRETHUB_CREDENTIAL: ${{ secrets.SECRETHUB_CREDENTIAL }}
          AZURE_TEST_MGR: secrethub://azure/dev/azureTest
      - name: Print environment with masked secrets
        run: env | sort
      - name: Print environment with masked secrets
        run: $AZURE_TEST_MGR
      # - name: 'Terraform Init'
      #   uses: hashicorp/terraform-github-actions@master
      #   with:
      #     tf_actions_subcommand: 'init'
      #     tf_actions_version: ${{ env.tf_version }}
      #     tf_actions_working_dir: ${{ env.tf_working_dir }}
      #     tf_actions_comment: true
      # - name: 'Terraform Plan'
      #   uses: hashicorp/terraform-github-actions@master
      #   with:
      #     tf_actions_subcommand: 'plan'
      #     tf_actions_version: ${{ env.tf_version }}
      #     tf_actions_working_dir: ${{ env.tf_working_dir }}
      #     tf_actions_comment: true
      #   env:
      #     ARM_CLIENT_ID: ${{ secrets.azureClientId }}
      #     ARM_CLIENT_SECRET: ${{ secrets.azureClientSecret }}
      #     ARM_SUBSCRIPTION_ID: ${{ secrets.azureSubscriptionId }}
      #     ARM_TENANT_ID: ${{ secrets.azureTenantId }}
      # - name: 'Terraform Apply'
      #   uses: hashicorp/terraform-github-actions@master
      #   with:
      #     tf_actions_subcommand: 'apply'
      #     tf_actions_version: ${{ env.tf_version }}
      #     tf_actions_working_dir: ${{ env.tf_working_dir }}
      #     tf_actions_comment: true
      #   env:
      #     ARM_CLIENT_ID: ${{ secrets.azureClientId }}
      #     ARM_CLIENT_SECRET: ${{ secrets.azureClientSecret }}
      #     ARM_SUBSCRIPTION_ID: ${{ secrets.azureSubscriptionId }}
      #     ARM_TENANT_ID: ${{ secrets.azureTenantId }}